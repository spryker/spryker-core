{% extends '@ProductCategory/Add/index.twig' %}
{% set yes_sure = 'Yes, I am sure' | trans %}
{% set submit_title = 'Delete' | trans %}
{% set widget_title = 'Category Delete' | trans %}
{% set widget_title = widget_title ~ ': ' ~ currentCategory.name %}

{% block content %}

    {% embed '@Gui/Partials/widget.twig' %}

        {% block widget_content %}

            {{ form_start(form) }}

            {{ form_errors(form) }}

            {{ form_rest(form) }}

            <input type="submit" class="btn btn-primary" value="{{ submit_title }}" disabled="disabled" id="submit_delete"/>
            <input type="checkbox" id="delete_confirm"/> {{ yes_sure }}
            <br/><br/>

            <div class="row">
                <div class="col-md-4"><b>Urls to be deleted</b>
                    {% if paths|length > 0 %}
                        <ul class="nodes">
                            {% for path in paths %}
                                <li data-node="{{ path.view_node_name }}">
                                    {{ path.url }}
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <ul>
                            <li>None</li>
                        </ul>
                    {% endif %}
                </div>

                <div class="col-md-4"><b>Products to be de / re assigned</b>
                    {% if products|length > 0 %}
                        <ul class="nodes">
                            {% for product in products %}
                                <li data-node="child">
                                    {{ product.name }} ({{ product.sku }})
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <ul>
                            <li>None</li>
                        </ul>
                    {% endif %}
                </div>

                <div class="col-md-4"><b>CMS blocks to be de assigned</b>
                    {% if blocks|length > 0 %}
                        <ul class="nodes">
                            {% for block in blocks %}
                                <li data-node="child">
                                    {{ block.name }}
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        <ul>
                            <li>None</li>
                        </ul>
                    {% endif %}
                </div>
            </div>

            {{ form_end(form) }}

        {% endblock %}

    {% endembed %}

{% endblock %}

{% block action %}
    {{ parent() }}
    {{ createActionButton('/product-category/add', 'Create Category' | trans) }}
{% endblock %}


{% block footer_js %}
    {{ parent() }}

    <script>
        $(document).ready(function() {
            //$('.nodes li[data-node="child"]').toggle($(this).prop('checked'));

            $('#form_delete_children')
                .off('click')
                .on('click', function(){
                    //$('.nodes li[data-node="child"]').toggle($(this).prop('checked'));
                    $('.spryker-form-select2combobox').val(null).trigger('change');
                });

            $('#form_fk_parent_category_node')
                .on('select2:select', function(){
                    $('#form_delete_children').prop('checked', false);
                });

            $('#delete_confirm')
                .off('click')
                .on('click', function(){
                    $('#submit_delete').prop('disabled', !$(this).prop('checked'));
                });
        });

    </script>
{% endblock %}
